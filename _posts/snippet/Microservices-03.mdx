---
title: "Microservices"
description: "마이크로 서비스"
language: "cloud_native"
category: "cloud_native"
update: "2024-10-28"
hide: false
serisenumber: 3
---
## Intro
---
- [Madan Reddy 강사님의 Master Microservices with SpringBoot,Docker,Kubernetes 강의를 듣고 TIL 방식으로 정리한 글입니다.](https://www.udemy.com/course/master-microservices-with-spring-docker-kubernetes/)

### 클라우드 네이티브
퍼블릭/프라이빗/클라우드 환경에서 컨테이너/서비스 메시 등 기존 설정 그대로 느슨하게 이루어진 구조로 어디든 공통적인 환경을 갖도록 하는 것이 클라우드 네이티브의 목적이다.

#### Microservice
클라우드 네이티브의 애플리케이션이며 느슨하게 결합되어 병렬 개발, 독립적 배포 및 확장이 가능한 유연성 제공 느슨하게 결합되어 일부 개선이 가능하다는 것이 클라우드 네이티브의 애플리케이션 중 하나라고 볼 수 있다.

비즈니스 로직 분리 후 컨테이너 분리 후 도커와 같은 환경으로 배포된다. 컨테이너는 가볍고 필요한 패키징만을 포함하기 때문에 여러 인프라에 걸쳐 이식성이 뛰어남.

수평 확장으로 트래픽 발생시 모든 트래픽 분리가 가능하며 더 많은 서비스 인스턴스를 추가하는 것도 쉽다. (K8s등의 도구로)

개발팀 운영팀과 사이에 중재하는 데브옵스 직책 또한 클라우드 네이티브가 기준으로 작동한다. 개발 간소화를 위한 통합/지속 제공/자동 배포 파이프라인 및 배포 프로세스 등.

### 클라우드 네이티브 앱과 기존 앱

서버 문제 발생시 기본 애플리케이션은 예측이 어렵지만 마이크로서비스의 경우 비즈니스 로직이 느슨히 결합되어 문제 추적이 쉽다.

클라우드 네이티브는 OS에 종속되지 않음. 컨테이너 기반.

독립적인 방식으로 환경이 구축되고 용량이 기존 앱 보다 적다.

데브옵스 원칙과 자동화로 지속 제공이 가능하다. 기존 앱은 폭포수 모델

신속한 복구와 자동화된 확장 제공 (K8s) 등

### 개발 표준 지침
[2012년 Heroku Cloud Platform 엔지니어링 팀의 12가지 요소의 방법론](https://12factor.net/)이 표준으로 전승되고 있다.
클라우드 네이티브 어플리케이션 개발을 위한 지침은 다음과 같다. 다음 요소들이 충족되어야 클라우드 네이티브앱이라 할 수 있다.

1. Codebase: 버전 제어에서 추적되는 하나의 코드베이스, 많은 배포
2. Dependencies: 명시적으로 종속성을 선언하고 격리
3. Config: 환경에 구성을 저장
4. Backing services: 백업 서비스를 첨부된 리소스로 처리
5. Build, release, run: 빌드와 실행 단계를 엄격하게 분리
6. Processes: 앱을 하나 이상의 상태 비저장 프로세스로 실행
7. Port binding: 포트 바인딩을 통한 서비스 내보내기
8. Concurrency: 프로세스 모델을 통한 확장
9. Disposability: 빠른 시작 및 우아한 종료로 견고성을 극대화
10. Dev/prod parity: 개발, 스테이징, 프로덕션을 최대한 유사하게 유지
11. Logs: 로그를 이벤트 스트림으로 처리
12. Admin processes: 관리/관리 작업을 일회성 프로세스로 실행

이에 추가로 Kevin Hoffman이 3가지 원칙을 더 추가해 15가지 원칙으로 계승되었다.

#### 하나의 코드베이스와 어플리케이션
두개 이상의 애플리케이션이 서로 공통된 코드가 존재하는지 탐색하고 공통 코드를 별도의 독립형 서비스로 배포해야한다. 도커 컨테이너 혹은 패키지 등 각 환경 배포 때마다 개별로 관리하지 않는다.

개발/테스트/운영 환경을 최대한 유사하게 유지해야 한다.

#### API를 먼저 생각하라
API 우선 접근 방으로 테스트 가능한 통합 작성 및 배포를 수행한다. API 도움으로 서비스를 이용하고 내부 수정사항을 반영한다.

#### 종속성 관리
종속 항목을 명시적으로 선언해야 한다. Maven, Gradle, pom.xml, build.gradle, pakage.json 등.

#### 디자인/빌드/릴리즈/실행
- 디자인 단계에서는 필요 기술 및 종속성 도구를 결정한다. 개발 및 단위 테스트 등을 설계한다.
- 빌드 단계에서는 필요 종속성을 사용하여 코드 베이스를 컴파일하고 패키징 한다. 이때 코드베이스는 누군가 수정해서는 안 될 정도로 공통화가 잘 되어 있어야 한다. 수동 작업은 권장하지 않는다.
- 릴리즈 단계에서는 코드 베이스 패키지를 배포 구성과 결합해야 한다. 데이터베이스 키, 폴더 구조, 서버 config, 마이크로서비스 config, 애플리케이션별 버전 등
- 실행 단계에서는 지정 환경에서 실행되어야 한다.(컨테이너 등)

#### 자격 증명 및 코드 config
코드에 포함되서는 안되며 기밀 사항인 데이터베이스 키등 모든 구성을 별도로 유지 관리 해야 한다. spring 환경에서는 Spring Cloud Config Server 등으로 관리할 수 있다.